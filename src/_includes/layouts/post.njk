---
layout: layouts/base.njk
---

<!-- Article Hero -->
<section class="article-hero">
  <div class="hero-grid"></div>
  <div class="hero-orb orb-1"></div>
  <div class="hero-orb orb-2"></div>
  <div class="article-hero-inner">
    <a href="/" class="back-link">‚Üê Back to all articles</a>
    {% if category %}
    <span class="article-tag tag-{{ category | lower }}">{{ category }}</span>
    {% endif %}
    <h1 class="article-hero-title">{{ title }}</h1>
    <div class="article-hero-meta">
      <span>{{ date | readableDate }}</span>
      <span class="divider"></span>
      <span>{{ content | readingTime }} min read</span>
      {% if author %}
      <span class="divider"></span>
      <span>By {{ author }}</span>
      {% endif %}
    </div>
  </div>
</section>

<!-- Article Body -->
<article class="article-body">
  {{ content | safe }}
</article>

<!-- Newsletter CTA at bottom of every article -->
<section id="newsletter">
  <div class="newsletter-bg-lines">
    <svg viewBox="0 0 1200 400" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 200 Q300 100 600 200 T1200 200" stroke="rgba(0,255,136,0.15)" stroke-width="1" fill="none"/>
      <path d="M0 250 Q300 150 600 250 T1200 250" stroke="rgba(255,45,107,0.1)" stroke-width="1" fill="none"/>
    </svg>
  </div>
  <div class="newsletter-inner">
    <div class="newsletter-icon">üêõ</div>
    <h2 class="newsletter-title reveal">Enjoyed this? Debug your thinking.</h2>
    <p class="newsletter-desc reveal">Get new brain bug breakdowns, stories, and mental model antidotes ‚Äî delivered to your inbox.</p>
    <form class="newsletter-form reveal" action="https://api.convertkit.com/v3/forms/9090233/subscribe" method="post" data-sv-form="9090233" onsubmit="handleSubscribe(event)">
      <input type="email" name="email_address" placeholder="your@email.com" required>
      <button type="submit">Subscribe</button>
    </form>
    <p class="newsletter-privacy reveal">No spam. Unsubscribe anytime.</p>
  </div>
</section>

<script>
function handleSubscribe(e) {
  e.preventDefault();
  const form = e.target;
  const input = form.querySelector('input');
  const btn = form.querySelector('button');
  const email = input.value;

  btn.textContent = 'Sending...';
  btn.disabled = true;

  fetch(form.action, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ api_key: 'SdZUv0f5wphPHqZFYBehkA', email: email })
  })
  .then(response => {
    if (response.ok || response.status === 200 || response.status === 302) {
      btn.textContent = '‚úì Subscribed!';
      btn.style.background = 'var(--accent-cyan)';
      input.value = '';
    } else {
      btn.textContent = 'Try again';
      btn.style.background = 'var(--accent-pink)';
    }
  })
  .catch(() => {
    const iframe = document.createElement('iframe');
    iframe.name = 'kit-frame';
    iframe.style.display = 'none';
    document.body.appendChild(iframe);
    form.target = 'kit-frame';
    form.removeAttribute('onsubmit');
    form.submit();
    btn.textContent = '‚úì Subscribed!';
    btn.style.background = 'var(--accent-cyan)';
    input.value = '';
    form.setAttribute('onsubmit', 'handleSubscribe(event)');
    form.removeAttribute('target');
    setTimeout(() => iframe.remove(), 5000);
  })
  .finally(() => {
    btn.disabled = false;
    setTimeout(() => {
      btn.textContent = 'Subscribe';
      btn.style.background = 'var(--accent-green)';
    }, 3000);
  });
}
</script>
